@model IEnumerable<ST10395938_POEPart2.Models.UserWithRoleViewModel>
@{
    ViewData["Title"] = "HR Dashboard";
}

<div class="d-flex justify-content-between align-items-center mb-4">
    <div>
        <h1 class="fw-bold" style="color: var(--primary-navy); margin-bottom: 0.25rem;">User Management</h1>
        <p class="text-muted mb-0">Manage all system users and their roles</p>
    </div>
    <div class="d-flex gap-2">
        <a class="btn btn-accent" asp-action="Create">
            <span>Add New User</span>
        </a>
        <a class="btn btn-primary" asp-action="GenerateReport">
            <span>Download User Report (PDF)</span>
        </a>
    </div>
</div>

<div class="card shadow-sm border-0">
    <div class="card-body p-0">
        <div class="table-responsive">
            <table class="table table-hover mb-0">
                <thead style="background: var(--primary-navy); color: white;">
                    <tr>
                        <th class="ps-4 py-3 fw-semibold">ID</th>
                        <th class="py-3 fw-semibold">Name</th>
                        <th class="py-3 fw-semibold">Email</th>
                        <th class="py-3 fw-semibold">Role</th>
                        <th class="py-3 fw-semibold">Hourly Rate</th>
                        <th class="pe-4 py-3 fw-semibold text-center">Actions</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var user in Model)
                    {
                        <tr style="border-left: 4px solid transparent; border-left-color: @GetRoleColor(user.Role);">
                            <td class="ps-4 py-3 fw-medium" style="color: var(--text-secondary);">@user.Id</td>
                            <td class="py-3">
                                <div class="fw-semibold" style="color: var(--text-primary);">@user.FirstName @user.LastName</div>
                            </td>
                            <td class="py-3" style="color: var(--text-secondary);">@user.Email</td>
                            <td class="py-3">
                                <span class="badge rounded-pill px-3 py-2" style="@GetRoleBadgeStyle(user.Role)">
                                    @user.Role
                                </span>
                            </td>
                            <td class="py-3 fw-semibold" style="color: var(--accent-teal);">
                                @($"R {user.HourlyRate:F2}")
                            </td>
                            <td class="pe-4 py-3 text-center">
                                <a class="btn btn-sm btn-outline-primary" asp-action="Edit" asp-route-id="@user.Id" title="Edit User">
                                    ✏️ Edit
                                </a>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
</div>

@functions {
    private string GetRoleBadgeStyle(string role)
    {
        return role?.ToLower() switch
        {
            "hr" => "background: rgba(13, 148, 136, 0.15); color: var(--accent-teal); border: 1px solid var(--accent-teal);",
            "lecturer" => "background: rgba(30, 58, 138, 0.15); color: var(--primary-navy); border: 1px solid var(--primary-navy);",
            "coordinator" => "background: rgba(217, 119, 6, 0.15); color: var(--accent-gold); border: 1px solid var(--accent-gold);",
            "manager" => "background: rgba(107, 114, 128, 0.15); color: var(--secondary-gray); border: 1px solid var(--secondary-gray);",
            _ => "background: rgba(107, 114, 128, 0.15); color: var(--secondary-gray); border: 1px solid var(--secondary-gray);"
        };
    }

    private string GetRoleColor(string role)
    {
        return role?.ToLower() switch
        {
            "hr" => "var(--accent-teal)",
            "lecturer" => "var(--primary-navy)",
            "coordinator" => "var(--accent-gold)",
            "manager" => "var(--secondary-gray)",
            _ => "var(--secondary-gray)"
        };
    }
}

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}